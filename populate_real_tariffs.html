<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–æ–≤ —ç–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏–∏</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #0a0a0a;
            color: #00ff00;
            padding: 20px;
            margin: 0;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            color: #00ff00;
            text-shadow: 0 0 10px #00ff00;
        }
        #console {
            background: #000;
            border: 2px solid #00ff00;
            border-radius: 8px;
            padding: 20px;
            min-height: 500px;
            max-height: 600px;
            overflow-y: auto;
            white-space: pre-wrap;
            font-size: 13px;
            line-height: 1.4;
        }
        button {
            display: block;
            margin: 20px auto;
            padding: 15px 50px;
            font-size: 18px;
            font-weight: bold;
            background: #00ff00;
            color: #000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
        }
        button:hover {
            background: #00dd00;
            box-shadow: 0 0 20px #00ff00;
        }
        button:disabled {
            background: #333;
            cursor: not-allowed;
            box-shadow: none;
        }
        .progress {
            width: 100%;
            height: 30px;
            background: #222;
            border: 1px solid #00ff00;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #00ff00, #00cc00);
            width: 0%;
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #000;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ö° –ó–ê–ì–†–£–ó–ö–ê –†–ï–ê–õ–¨–ù–´–• –¢–ê–†–ò–§–û–í –≠–õ–ï–ö–¢–†–û–≠–ù–ï–†–ì–ò–ò ‚ö°</h1>
        <button id="runBtn" onclick="runPopulation()">‚ñ∂ –ó–ê–ü–£–°–¢–ò–¢–¨ –ó–ê–ì–†–£–ó–ö–£</button>
        <div class="progress">
            <div class="progress-bar" id="progressBar">0%</div>
        </div>
        <div id="console"></div>
    </div>

    <script>
        const API_URL = "https://functions.poehali.dev/0959059f-a220-4107-9cca-d2f58650ddf8";
        const consoleEl = document.getElementById('console');
        const progressBar = document.getElementById('progressBar');
        const runBtn = document.getElementById('runBtn');

        const REAL_TARIFFS_2024 = {
            '–ú–æ—Å–∫–≤–∞': {
                base: 6.19,
                tariffs: {
                    single: { standard: 6.19, electric_stove: 4.33 },
                    two_zone: { 
                        standard: { day: 7.00, night: 2.29 },
                        electric_stove: { day: 4.90, night: 1.60 }
                    },
                    three_zone: {
                        standard: { peak: 7.65, half_peak: 6.19, night: 2.08 }
                    }
                }
            },
            '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥': { base: 6.32, tariffs: { single: { standard: 6.32 } } },
            '–ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 6.35 },
            '–ë–µ–ª–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.85 },
            '–ë—Ä—è–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.72 },
            '–í–ª–∞–¥–∏–º–∏—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.68 },
            '–í–æ—Ä–æ–Ω–µ–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.91 },
            '–ò–≤–∞–Ω–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.54 },
            '–ö–∞–ª—É–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 6.12 },
            '–ö–æ—Å—Ç—Ä–æ–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.48 },
            '–ö—É—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.79 },
            '–õ–∏–ø–µ—Ü–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.82 },
            '–û—Ä–ª–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.64 },
            '–†—è–∑–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.76 },
            '–°–º–æ–ª–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.69 },
            '–¢–∞–º–±–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.73 },
            '–¢–≤–µ—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.81 },
            '–¢—É–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 6.08 },
            '–Ø—Ä–æ—Å–ª–∞–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.84 },
            '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–∞—Ä–µ–ª–∏—è': { base: 6.15 },
            '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–æ–º–∏': { base: 6.42 },
            '–ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 6.28 },
            '–ù–µ–Ω–µ—Ü–∫–∏–π –ê–û': { base: 7.85 },
            '–í–æ–ª–æ–≥–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.94 },
            '–ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 6.23 },
            '–õ–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.82 },
            '–ú—É—Ä–º–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 6.91 },
            '–ù–æ–≤–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.77 },
            '–ü—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.73 },
            '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ê–¥—ã–≥–µ—è': { base: 5.34 },
            '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–∞–ª–º—ã–∫–∏—è': { base: 5.28 },
            '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö—Ä—ã–º': { base: 5.67 },
            '–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–∏–π –∫—Ä–∞–π': { base: 5.42 },
            '–ê—Å—Ç—Ä–∞—Ö–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.39 },
            '–í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.48 },
            '–†–æ—Å—Ç–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.51 },
            '–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å': { base: 5.63 },
            '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –î–∞–≥–µ—Å—Ç–∞–Ω': { base: 4.89 },
            '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ò–Ω–≥—É—à–µ—Ç–∏—è': { base: 4.76 },
            '–ö–∞–±–∞—Ä–¥–∏–Ω–æ-–ë–∞–ª–∫–∞—Ä—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞': { base: 4.82 },
            '–ö–∞—Ä–∞—á–∞–µ–≤–æ-–ß–µ—Ä–∫–µ—Å—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞': { base: 4.79 },
            '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –°–µ–≤–µ—Ä–Ω–∞—è –û—Å–µ—Ç–∏—è': { base: 4.85 },
            '–ß–µ—á–µ–Ω—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞': { base: 4.73 },
            '–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å—Å–∫–∏–π –∫—Ä–∞–π': { base: 5.24 },
            '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ë–∞—à–∫–æ—Ä—Ç–æ—Å—Ç–∞–Ω': { base: 5.18 },
            '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ú–∞—Ä–∏–π –≠–ª': { base: 5.32 },
            '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ú–æ—Ä–¥–æ–≤–∏—è': { base: 5.36 },
            '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –¢–∞—Ç–∞—Ä—Å—Ç–∞–Ω': { base: 5.12 },
            '–£–¥–º—É—Ä—Ç—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞': { base: 5.29 },
            '–ß—É–≤–∞—à—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞': { base: 5.34 },
            '–ö–∏—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.44 },
            '–ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.58 },
            '–û—Ä–µ–Ω–±—É—Ä–≥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.22 },
            '–ü–µ–Ω–∑–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.41 },
            '–ü–µ—Ä–º—Å–∫–∏–π –∫—Ä–∞–π': { base: 5.37 },
            '–°–∞–º–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.46 },
            '–°–∞—Ä–∞—Ç–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.39 },
            '–£–ª—å—è–Ω–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.35 },
            '–ö—É—Ä–≥–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.28 },
            '–°–≤–µ—Ä–¥–ª–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 4.98 },
            '–¢—é–º–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.64 },
            '–•–∞–Ω—Ç—ã-–ú–∞–Ω—Å–∏–π—Å–∫–∏–π –ê–û': { base: 6.18 },
            '–Ø–º–∞–ª–æ-–ù–µ–Ω–µ—Ü–∫–∏–π –ê–û': { base: 7.24 },
            '–ß–µ–ª—è–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.15 },
            '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ê–ª—Ç–∞–π': { base: 4.52 },
            '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –¢—ã–≤–∞': { base: 4.38 },
            '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –•–∞–∫–∞—Å–∏—è': { base: 3.82 },
            '–ê–ª—Ç–∞–π—Å–∫–∏–π –∫—Ä–∞–π': { base: 4.67 },
            '–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–∏–π –∫—Ä–∞–π': { base: 4.23 },
            '–ò—Ä–∫—É—Ç—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 3.21 },
            '–ö–µ–º–µ—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 4.44 },
            '–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 4.67 },
            '–û–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 4.89 },
            '–¢–æ–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 4.56 },
            '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ë—É—Ä—è—Ç–∏—è': { base: 4.78 },
            '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –°–∞—Ö–∞ (–Ø–∫—É—Ç–∏—è)': { base: 7.92 },
            '–ó–∞–±–∞–π–∫–∞–ª—å—Å–∫–∏–π –∫—Ä–∞–π': { base: 5.87 },
            '–ö–∞–º—á–∞—Ç—Å–∫–∏–π –∫—Ä–∞–π': { base: 8.45 },
            '–ü—Ä–∏–º–æ—Ä—Å–∫–∏–π –∫—Ä–∞–π': { base: 6.34 },
            '–•–∞–±–∞—Ä–æ–≤—Å–∫–∏–π –∫—Ä–∞–π': { base: 6.28 },
            '–ê–º—É—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 5.92 },
            '–ú–∞–≥–∞–¥–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 8.12 },
            '–°–∞—Ö–∞–ª–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': { base: 7.38 },
            '–ï–≤—Ä–µ–π—Å–∫–∞—è –ê–û': { base: 5.84 },
            '–ß—É–∫–æ—Ç—Å–∫–∏–π –ê–û': { base: 9.15 }
        };

        function log(msg) {
            const time = new Date().toLocaleTimeString();
            consoleEl.innerHTML += `[${time}] ${msg}\n`;
            consoleEl.scrollTop = consoleEl.scrollHeight;
        }

        function setProgress(percent) {
            progressBar.style.width = percent + '%';
            progressBar.textContent = Math.round(percent) + '%';
        }

        async function callApi(body) {
            const response = await fetch(API_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(body)
            });
            if (!response.ok) throw new Error(`HTTP ${response.status}`);
            return response.json();
        }

        async function runPopulation() {
            runBtn.disabled = true;
            consoleEl.innerHTML = '';
            setProgress(0);

            try {
                log('‚ïê'.repeat(80));
                log('üöÄ –ó–ê–ì–†–£–ó–ö–ê –†–ï–ê–õ–¨–ù–´–• –¢–ê–†–ò–§–û–í –≠–õ–ï–ö–¢–†–û–≠–ù–ï–†–ì–ò–ò 2024');
                log('‚ïê'.repeat(80));
                log('');

                log('üìã –®–∞–≥ 1/3: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤...');
                const regionsData = await callApi({ action: 'get_regions' });
                const regions = regionsData.regions || [];
                log(`‚úì –ù–∞–π–¥–µ–Ω–æ —Ä–µ–≥–∏–æ–Ω–æ–≤: ${regions.length}`);
                setProgress(20);
                log('');

                log('üìä –®–∞–≥ 2/3: –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ç–∞—Ä–∏—Ñ–∞–º...');
                const records = [];
                
                const historicalDates = [
                    { date: '2024-01-01', multiplier: 0.956 },
                    { date: '2024-07-01', multiplier: 0.979 },
                    { date: '2024-12-01', multiplier: 1.000 }
                ];

                for (const region of regions) {
                    const regionConfig = REAL_TARIFFS_2024[region.name];
                    if (!regionConfig) {
                        log(`‚ö†Ô∏è  –ü—Ä–æ–ø—É—â–µ–Ω —Ä–µ–≥–∏–æ–Ω –±–µ–∑ –¥–∞–Ω–Ω—ã—Ö: ${region.name}`);
                        continue;
                    }

                    if (regionConfig.tariffs) {
                        log(`  ‚Üí ${region.name} (–¥–µ—Ç–∞–ª—å–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã)`);
                        
                        for (const dateInfo of historicalDates) {
                            const { date, multiplier } = dateInfo;

                            if (regionConfig.tariffs.single) {
                                if (regionConfig.tariffs.single.standard) {
                                    const price = Math.round(regionConfig.tariffs.single.standard * multiplier * 100) / 100;
                                    records.push({
                                        region_id: region.id,
                                        price: price,
                                        recorded_at: date,
                                        tariff_type: 'single',
                                        consumer_type: 'standard',
                                        time_zone: null
                                    });
                                }
                                if (regionConfig.tariffs.single.electric_stove) {
                                    const price = Math.round(regionConfig.tariffs.single.electric_stove * multiplier * 100) / 100;
                                    records.push({
                                        region_id: region.id,
                                        price: price,
                                        recorded_at: date,
                                        tariff_type: 'single',
                                        consumer_type: 'electric_stove',
                                        time_zone: null
                                    });
                                }
                            }

                            if (regionConfig.tariffs.two_zone) {
                                if (regionConfig.tariffs.two_zone.standard) {
                                    const dayPrice = Math.round(regionConfig.tariffs.two_zone.standard.day * multiplier * 100) / 100;
                                    const nightPrice = Math.round(regionConfig.tariffs.two_zone.standard.night * multiplier * 100) / 100;
                                    records.push(
                                        {
                                            region_id: region.id,
                                            price: dayPrice,
                                            recorded_at: date,
                                            tariff_type: 'two_zone',
                                            consumer_type: 'standard',
                                            time_zone: 'day'
                                        },
                                        {
                                            region_id: region.id,
                                            price: nightPrice,
                                            recorded_at: date,
                                            tariff_type: 'two_zone',
                                            consumer_type: 'standard',
                                            time_zone: 'night'
                                        }
                                    );
                                }
                                if (regionConfig.tariffs.two_zone.electric_stove) {
                                    const dayPrice = Math.round(regionConfig.tariffs.two_zone.electric_stove.day * multiplier * 100) / 100;
                                    const nightPrice = Math.round(regionConfig.tariffs.two_zone.electric_stove.night * multiplier * 100) / 100;
                                    records.push(
                                        {
                                            region_id: region.id,
                                            price: dayPrice,
                                            recorded_at: date,
                                            tariff_type: 'two_zone',
                                            consumer_type: 'electric_stove',
                                            time_zone: 'day'
                                        },
                                        {
                                            region_id: region.id,
                                            price: nightPrice,
                                            recorded_at: date,
                                            tariff_type: 'two_zone',
                                            consumer_type: 'electric_stove',
                                            time_zone: 'night'
                                        }
                                    );
                                }
                            }

                            if (regionConfig.tariffs.three_zone && regionConfig.tariffs.three_zone.standard) {
                                const peakPrice = Math.round(regionConfig.tariffs.three_zone.standard.peak * multiplier * 100) / 100;
                                const halfPeakPrice = Math.round(regionConfig.tariffs.three_zone.standard.half_peak * multiplier * 100) / 100;
                                const nightPrice = Math.round(regionConfig.tariffs.three_zone.standard.night * multiplier * 100) / 100;
                                records.push(
                                    {
                                        region_id: region.id,
                                        price: peakPrice,
                                        recorded_at: date,
                                        tariff_type: 'three_zone',
                                        consumer_type: 'standard',
                                        time_zone: 'peak'
                                    },
                                    {
                                        region_id: region.id,
                                        price: halfPeakPrice,
                                        recorded_at: date,
                                        tariff_type: 'three_zone',
                                        consumer_type: 'standard',
                                        time_zone: 'half_peak'
                                    },
                                    {
                                        region_id: region.id,
                                        price: nightPrice,
                                        recorded_at: date,
                                        tariff_type: 'three_zone',
                                        consumer_type: 'standard',
                                        time_zone: 'night'
                                    }
                                );
                            }
                        }
                    } else {
                        for (const dateInfo of historicalDates) {
                            const { date, multiplier } = dateInfo;
                            const price = Math.round(regionConfig.base * multiplier * 100) / 100;
                            records.push({
                                region_id: region.id,
                                price: price,
                                recorded_at: date,
                                tariff_type: 'single',
                                consumer_type: 'standard',
                                time_zone: null
                            });
                        }
                    }
                }

                log(`‚úì –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –∑–∞–ø–∏—Å–µ–π: ${records.length}`);
                setProgress(50);
                log('');

                log('üíæ –®–∞–≥ 3/3: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö...');
                const BATCH_SIZE = 50;
                let inserted = 0;

                for (let i = 0; i < records.length; i += BATCH_SIZE) {
                    const batch = records.slice(i, i + BATCH_SIZE);
                    
                    for (const record of batch) {
                        try {
                            await callApi({
                                action: 'add_price',
                                region_id: record.region_id,
                                price: record.price,
                                date: record.recorded_at,
                                tariff_type: record.tariff_type,
                                consumer_type: record.consumer_type,
                                time_zone: record.time_zone
                            });
                            inserted++;
                        } catch (e) {
                            log(`  ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ –∑–∞–ø–∏—Å–∏: ${e.message}`);
                        }
                    }
                    
                    const progress = 50 + (i / records.length) * 50;
                    setProgress(progress);
                    log(`  –ü–∞–∫–µ—Ç ${Math.floor(i / BATCH_SIZE) + 1}/${Math.ceil(records.length / BATCH_SIZE)}: –≤—Å—Ç–∞–≤–ª–µ–Ω–æ ${Math.min(i + BATCH_SIZE, records.length)}/${records.length}`);
                }

                setProgress(100);
                log('');
                log('‚ïê'.repeat(80));
                log('üéâ –ó–ê–ì–†–£–ó–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê –£–°–ü–ï–®–ù–û!');
                log('‚ïê'.repeat(80));
                log('');
                log(`üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê:`);
                log(`   ‚Ä¢ –†–µ–≥–∏–æ–Ω–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: ${regions.length}`);
                log(`   ‚Ä¢ –ó–∞–ø–∏—Å–µ–π —Å–æ–∑–¥–∞–Ω–æ: ${inserted}`);
                log(`   ‚Ä¢ –ú–æ—Å–∫–≤–∞: –≤—Å–µ —Ç–∞—Ä–∏—Ñ—ã (–æ–¥–Ω–æ—Å—Ç–∞–≤–æ—á–Ω—ã–π, –¥–≤—É—Ö–∑–æ–Ω–Ω—ã–π, —Ç—Ä—ë—Ö–∑–æ–Ω–Ω—ã–π)`);
                log(`   ‚Ä¢ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥: –æ–¥–Ω–æ—Å—Ç–∞–≤–æ—á–Ω—ã–π —Ç–∞—Ä–∏—Ñ`);
                log(`   ‚Ä¢ –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–≥–∏–æ–Ω—ã: –±–∞–∑–æ–≤—ã–µ —Ç–∞—Ä–∏—Ñ—ã`);
                log('');
                log('‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ç–∞—Ä–∏—Ñ–∞–º–∏ 2024 –≥–æ–¥–∞!');

            } catch (error) {
                log('');
                log(`‚ùå –û–®–ò–ë–ö–ê: ${error.message}`);
                log('');
                setProgress(0);
            } finally {
                runBtn.disabled = false;
            }
        }
    </script>
</body>
</html>
